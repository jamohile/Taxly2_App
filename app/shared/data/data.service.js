"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var core_1 = require("@angular/core");
var http_1 = require("@angular/http");
var config_1 = require("../config");
var datayear_1 = require("../data/datayear/datayear");
var DataService = DataService_1 = (function () {
    function DataService(http) {
        this.http = http;
        //a year can be statically saved, for transfer between pages
        this.month_names = [
            "January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"
        ];
    }
    DataService.prototype.load = function (year, successful) {
        var headers = new http_1.Headers();
        headers.append('auth_token', config_1.Config.token);
        this.http.get(config_1.Config.url + "data/" + year, { headers: headers }).toPromise().then(function (response) {
            var dataYear = new datayear_1.DataYear(response._body.year, response._body.fields, response._body.months);
            successful(dataYear);
        });
    };
    DataService.prototype.save = function (successful) {
        var headers = new http_1.Headers();
        headers.append('auth_token', config_1.Config.token);
        headers.append('mode', 'update');
        this.http.post(config_1.Config.url + "data/" + DataService_1.dataYear.year, DataService_1.dataYear, { headers: headers }).toPromise().then(function (response) {
            successful();
        });
    };
    DataService.prototype.getMonth = function (month_name) {
        for (var x = 0; x < DataService_1.dataYear.months.length; x++) {
            var month = DataService_1.dataYear.months[x];
            if (month.month == month_name) {
                return month;
            }
        }
    };
    DataService.prototype.addMonth = function (newDataMonth) {
        this.removeDuplicateMonth(newDataMonth.month);
        DataService_1.dataYear.months.push(newDataMonth);
    };
    DataService.prototype.removeDuplicateMonth = function (month) {
        DataService_1.dataYear.months.forEach(function (dataMonth) {
            if (dataMonth.month == month) {
                DataService_1.dataYear.months.splice(DataService_1.dataYear.months.indexOf(dataMonth), 1);
                return;
            }
        });
    };
    DataService.prototype.setYearForTransport = function (dataYear) {
        DataService_1.dataYear = dataYear;
    };
    DataService.prototype.getYearFromTransport = function () {
        return DataService_1.dataYear;
    };
    DataService.prototype.setBulkObject = function (name, object) {
        DataService_1.bulk[name] = object;
    };
    DataService.prototype.getBulkObject = function (name, remove) {
        console.log(name);
        console.dir(DataService_1.bulk[name]);
        var object = DataService_1.bulk[name];
        if (remove) {
            delete DataService_1.bulk[name];
        }
        return object;
    };
    DataService.prototype.hasBulkObject = function (name) {
        return DataService_1.bulk[name] != undefined;
    };
    DataService.prototype.changeFieldName = function (old, changed) {
        DataService_1.dataYear.fields.forEach(function (field) {
            if (field.name == old) {
                field.name = changed;
            }
        });
        DataService_1.dataYear.months.forEach(function (month) {
            month.fields.forEach(function (field) {
                if (field.name == old) {
                    field.name = changed;
                }
            });
        });
    };
    return DataService;
}());
//used to transfer open-ended data between pages
DataService.bulk = new Object();
DataService = DataService_1 = __decorate([
    core_1.Injectable(),
    __metadata("design:paramtypes", [http_1.Http])
], DataService);
exports.DataService = DataService;
var DataService_1;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZGF0YS5zZXJ2aWNlLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiZGF0YS5zZXJ2aWNlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBQUEsc0NBQTJDO0FBQzNDLHNDQUF3RDtBQUl4RCxvQ0FBbUM7QUFDbkMsc0RBQXFEO0FBT3JELElBQWEsV0FBVztJQVFwQixxQkFBb0IsSUFBVTtRQUFWLFNBQUksR0FBSixJQUFJLENBQU07UUFQOUIsNERBQTREO1FBQzVELGdCQUFXLEdBQWE7WUFDcEIsU0FBUyxFQUFFLFVBQVUsRUFBRSxPQUFPLEVBQUUsT0FBTyxFQUFFLEtBQUssRUFBRSxNQUFNLEVBQUUsTUFBTSxFQUFFLFFBQVEsRUFBRSxXQUFXLEVBQUUsU0FBUyxFQUFFLFVBQVUsRUFBRSxVQUFVO1NBQUMsQ0FBQztJQUs1RixDQUFDO0lBQ25DLDBCQUFJLEdBQUosVUFBSyxJQUFZLEVBQUUsVUFBd0M7UUFDdkQsSUFBSSxPQUFPLEdBQUcsSUFBSSxjQUFPLEVBQUUsQ0FBQztRQUM1QixPQUFPLENBQUMsTUFBTSxDQUFDLFlBQVksRUFBRSxlQUFNLENBQUMsS0FBSyxDQUFDLENBQUM7UUFDM0MsSUFBSSxDQUFDLElBQUksQ0FBQyxHQUFHLENBQ1QsZUFBTSxDQUFDLEdBQUcsR0FBRyxPQUFPLEdBQUcsSUFBSSxFQUMzQixFQUFFLE9BQU8sRUFBRSxPQUFPLEVBQUUsQ0FDdkIsQ0FBQyxTQUFTLEVBQUUsQ0FBQyxJQUFJLENBQUMsVUFBQyxRQUFhO1lBQzdCLElBQUksUUFBUSxHQUFhLElBQUksbUJBQVEsQ0FBQyxRQUFRLENBQUMsS0FBSyxDQUFDLElBQUksRUFBRSxRQUFRLENBQUMsS0FBSyxDQUFDLE1BQU0sRUFBRSxRQUFRLENBQUMsS0FBSyxDQUFDLE1BQU0sQ0FBQyxDQUFDO1lBQ3pHLFVBQVUsQ0FBQyxRQUFRLENBQUMsQ0FBQztRQUN6QixDQUFDLENBQUMsQ0FBQztJQUNQLENBQUM7SUFDRCwwQkFBSSxHQUFKLFVBQUssVUFBc0I7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TUFBTSxDQUFDLGFBQVcsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLElBQUksU0FBUyxDQUFDO0lBQy9DLENBQUM7SUFDRCxxQ0FBZSxHQUFmLFVBQWdCLEdBQVcsRUFBRSxPQUFlO1FBQ3hDLGFBQVcsQ0FBQyxRQUFRLENBQUMsTUFBTSxDQUFDLE9BQU8sQ0FBQyxVQUFDLEtBQWdCO1lBQ2pELEVBQUUsQ0FBQyxDQUFDLEtBQUssQ0FBQyxJQUFJLElBQUksR0FBRyxDQUFDLENBQUMsQ0FBQztnQkFDcEIsS0FBSyxDQUFDLElBQUksR0FBRyxPQUFPLENBQUM7WUFDekIsQ0FBQztRQUNMLENBQUMsQ0FBQyxDQUFDO1FBQ0gsYUFBVyxDQUFDLFFBQVEsQ0FBQyxNQUFNLENBQUMsT0FBTyxDQUFDLFVBQUMsS0FBZ0I7WUFDakQsS0FBSyxDQUFDLE1BQU0sQ0FBQyxPQUFPLENBQUMsVUFBQyxLQUFZO2dCQUM5QixFQUFFLENBQUMsQ0FBQyxLQUFLLENBQUMsSUFBSSxJQUFJLEdBQUcsQ0FBQyxDQUFDLENBQUM7b0JBQ3BCLEtBQUssQ0FBQyxJQUFJLEdBQUcsT0FBTyxDQUFDO2dCQUN6QixDQUFDO1lBQ0wsQ0FBQyxDQUFDLENBQUE7UUFDTixDQUFDLENBQUMsQ0FBQztJQUNQLENBQUM7SUFDTCxrQkFBQztBQUFELENBQUMsQUF2RkQsSUF1RkM7QUFqRkcsZ0RBQWdEO0FBQ3pDLGdCQUFJLEdBQVcsSUFBSSxNQUFNLEVBQUUsQ0FBQztBQVAxQixXQUFXO0lBRnZCLGlCQUFVLEVBQUU7cUNBVWlCLFdBQUk7R0FSckIsV0FBVyxDQXVGdkI7QUF2Rlksa0NBQVciLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBJbmplY3RhYmxlIH0gZnJvbSBcIkBhbmd1bGFyL2NvcmVcIjtcclxuaW1wb3J0IHsgSHR0cCwgSGVhZGVycywgUmVzcG9uc2UgfSBmcm9tIFwiQGFuZ3VsYXIvaHR0cFwiO1xyXG5pbXBvcnQgeyBPYnNlcnZhYmxlIH0gZnJvbSBcInJ4anMvUnhcIjtcclxuXHJcbmltcG9ydCB7IFVzZXIgfSBmcm9tIFwiLi4vdXNlci91c2VyXCI7XHJcbmltcG9ydCB7IENvbmZpZyB9IGZyb20gXCIuLi9jb25maWdcIjtcclxuaW1wb3J0IHsgRGF0YVllYXIgfSBmcm9tIFwiLi4vZGF0YS9kYXRheWVhci9kYXRheWVhclwiO1xyXG5pbXBvcnQgeyBEYXRhTW9udGggfSBmcm9tIFwiLi4vZGF0YS9kYXRhbW9udGgvZGF0YW1vbnRoXCI7XHJcbmltcG9ydCB7IEZpZWxkIH0gZnJvbSBcIi4uL2ZpZWxkL2ZpZWxkXCI7XHJcbmltcG9ydCB7IEZpZWxkRGF0YSB9IGZyb20gXCIuLi9maWVsZC9maWVsZC5kYXRhXCI7XHJcblxyXG5ASW5qZWN0YWJsZSgpXHJcblxyXG5leHBvcnQgY2xhc3MgRGF0YVNlcnZpY2Uge1xyXG4gICAgLy9hIHllYXIgY2FuIGJlIHN0YXRpY2FsbHkgc2F2ZWQsIGZvciB0cmFuc2ZlciBiZXR3ZWVuIHBhZ2VzXHJcbiAgICBtb250aF9uYW1lczogc3RyaW5nW10gPSBbXHJcbiAgICAgICAgXCJKYW51YXJ5XCIsIFwiRmVicnVhcnlcIiwgXCJNYXJjaFwiLCBcIkFwcmlsXCIsIFwiTWF5XCIsIFwiSnVuZVwiLCBcIkp1bHlcIiwgXCJBdWd1c3RcIiwgXCJTZXB0ZW1iZXJcIiwgXCJPY3RvYmVyXCIsIFwiTm92ZW1iZXJcIiwgXCJEZWNlbWJlclwiXTtcclxuXHJcbiAgICBzdGF0aWMgZGF0YVllYXI6IERhdGFZZWFyO1xyXG4gICAgLy91c2VkIHRvIHRyYW5zZmVyIG9wZW4tZW5kZWQgZGF0YSBiZXR3ZWVuIHBhZ2VzXHJcbiAgICBzdGF0aWMgYnVsazogT2JqZWN0ID0gbmV3IE9iamVjdCgpO1xyXG4gICAgY29uc3RydWN0b3IocHJpdmF0ZSBodHRwOiBIdHRwKSB7IH1cclxuICAgIGxvYWQoeWVhcjogbnVtYmVyLCBzdWNjZXNzZnVsOiAoZGF0YVllYXI6IERhdGFZZWFyKSA9PiB2b2lkKSB7XHJcbiAgICAgICAgbGV0IGhlYWRlcnMgPSBuZXcgSGVhZGVycygpO1xyXG4gICAgICAgIGhlYWRlcnMuYXBwZW5kKCdhdXRoX3Rva2VuJywgQ29uZmlnLnRva2VuKTtcclxuICAgICAgICB0aGlzLmh0dHAuZ2V0KFxyXG4gICAgICAgICAgICBDb25maWcudXJsICsgXCJkYXRhL1wiICsgeWVhcixcclxuICAgICAgICAgICAgeyBoZWFkZXJzOiBoZWFkZXJzIH1cclxuICAgICAgICApLnRvUHJvbWlzZSgpLnRoZW4oKHJlc3BvbnNlOiBhbnkpID0+IHtcclxuICAgICAgICAgICAgdmFyIGRhdGFZZWFyOiBEYXRhWWVhciA9IG5ldyBEYXRhWWVhcihyZXNwb25zZS5fYm9keS55ZWFyLCByZXNwb25zZS5fYm9keS5maWVsZHMsIHJlc3BvbnNlLl9ib2R5Lm1vbnRocyk7XHJcbiAgICAgICAgICAgIHN1Y2Nlc3NmdWwoZGF0YVllYXIpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgc2F2ZShzdWNjZXNzZnVsOiAoKSA9PiB2b2lkKSB7XHJcbiAgICAgICAgbGV0IGhlYWRlcnMgPSBuZXcgSGVhZGVycygpO1xyXG4gICAgICAgIGhlYWRlcnMuYXBwZW5kKCdhdXRoX3Rva2VuJywgQ29uZmlnLnRva2VuKTtcclxuICAgICAgICBoZWFkZXJzLmFwcGVuZCgnbW9kZScsICd1cGRhdGUnKTtcclxuICAgICAgICB0aGlzLmh0dHAucG9zdChcclxuICAgICAgICAgICAgQ29uZmlnLnVybCArIFwiZGF0YS9cIiArIERhdGFTZXJ2aWNlLmRhdGFZZWFyLnllYXIsXHJcbiAgICAgICAgICAgIERhdGFTZXJ2aWNlLmRhdGFZZWFyLFxyXG4gICAgICAgICAgICB7IGhlYWRlcnM6IGhlYWRlcnMgfVxyXG4gICAgICAgICkudG9Qcm9taXNlKCkudGhlbigocmVzcG9uc2U6IFJlc3BvbnNlKSA9PiB7XHJcbiAgICAgICAgICAgIHN1Y2Nlc3NmdWwoKTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuICAgIGdldE1vbnRoKG1vbnRoX25hbWU6IHN0cmluZyk6IERhdGFNb250aCB7XHJcbiAgICAgICAgZm9yICh2YXIgeCA9IDA7IHggPCBEYXRhU2VydmljZS5kYXRhWWVhci5tb250aHMubGVuZ3RoOyB4KyspIHtcclxuICAgICAgICAgICAgdmFyIG1vbnRoOiBEYXRhTW9udGggPSBEYXRhU2VydmljZS5kYXRhWWVhci5tb250aHNbeF07XHJcbiAgICAgICAgICAgIGlmIChtb250aC5tb250aCA9PSBtb250aF9uYW1lKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbW9udGg7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBhZGRNb250aChuZXdEYXRhTW9udGg6IERhdGFNb250aCkge1xyXG4gICAgICAgIHRoaXMucmVtb3ZlRHVwbGljYXRlTW9udGgobmV3RGF0YU1vbnRoLm1vbnRoKTtcclxuICAgICAgICBEYXRhU2VydmljZS5kYXRhWWVhci5tb250aHMucHVzaChuZXdEYXRhTW9udGgpO1xyXG4gICAgfVxyXG4gICAgcmVtb3ZlRHVwbGljYXRlTW9udGgobW9udGg6IHN0cmluZykge1xyXG4gICAgICAgIERhdGFTZXJ2aWNlLmRhdGFZZWFyLm1vbnRocy5mb3JFYWNoKChkYXRhTW9udGg6IERhdGFNb250aCkgPT4ge1xyXG4gICAgICAgICAgICBpZiAoZGF0YU1vbnRoLm1vbnRoID09IG1vbnRoKSB7XHJcbiAgICAgICAgICAgICAgICBEYXRhU2VydmljZS5kYXRhWWVhci5tb250aHMuc3BsaWNlKERhdGFTZXJ2aWNlLmRhdGFZZWFyLm1vbnRocy5pbmRleE9mKGRhdGFNb250aCksIDEpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICBzZXRZZWFyRm9yVHJhbnNwb3J0KGRhdGFZZWFyOiBEYXRhWWVhcikge1xyXG4gICAgICAgIERhdGFTZXJ2aWNlLmRhdGFZZWFyID0gZGF0YVllYXI7XHJcbiAgICB9XHJcbiAgICBnZXRZZWFyRnJvbVRyYW5zcG9ydCgpOiBEYXRhWWVhciB7XHJcbiAgICAgICAgcmV0dXJuIERhdGFTZXJ2aWNlLmRhdGFZZWFyO1xyXG4gICAgfVxyXG4gICAgc2V0QnVsa09iamVjdChuYW1lOiBzdHJpbmcsIG9iamVjdDogRmllbGREYXRhW10pIHtcclxuICAgICAgICBEYXRhU2VydmljZS5idWxrW25hbWVdID0gb2JqZWN0O1xyXG4gICAgfVxyXG4gICAgZ2V0QnVsa09iamVjdChuYW1lOiBzdHJpbmcsIHJlbW92ZTogYm9vbGVhbik6IEZpZWxkRGF0YVtdIHtcclxuICAgICAgICBjb25zb2xlLmxvZyhuYW1lKTtcclxuICAgICAgICBjb25zb2xlLmRpcihEYXRhU2VydmljZS5idWxrW25hbWVdKTtcclxuICAgICAgICB2YXIgb2JqZWN0ID0gRGF0YVNlcnZpY2UuYnVsa1tuYW1lXTtcclxuICAgICAgICBpZiAocmVtb3ZlKSB7XHJcbiAgICAgICAgICAgIGRlbGV0ZSBEYXRhU2VydmljZS5idWxrW25hbWVdO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gb2JqZWN0O1xyXG4gICAgfVxyXG4gICAgaGFzQnVsa09iamVjdChuYW1lOiBzdHJpbmcpOiBib29sZWFuIHtcclxuICAgICAgICByZXR1cm4gRGF0YVNlcnZpY2UuYnVsa1tuYW1lXSAhPSB1bmRlZmluZWQ7XHJcbiAgICB9XHJcbiAgICBjaGFuZ2VGaWVsZE5hbWUob2xkOiBzdHJpbmcsIGNoYW5nZWQ6IHN0cmluZykge1xyXG4gICAgICAgIERhdGFTZXJ2aWNlLmRhdGFZZWFyLmZpZWxkcy5mb3JFYWNoKChmaWVsZDogRmllbGREYXRhKSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChmaWVsZC5uYW1lID09IG9sZCkge1xyXG4gICAgICAgICAgICAgICAgZmllbGQubmFtZSA9IGNoYW5nZWQ7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICBEYXRhU2VydmljZS5kYXRhWWVhci5tb250aHMuZm9yRWFjaCgobW9udGg6IERhdGFNb250aCkgPT4ge1xyXG4gICAgICAgICAgICBtb250aC5maWVsZHMuZm9yRWFjaCgoZmllbGQ6IEZpZWxkKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBpZiAoZmllbGQubmFtZSA9PSBvbGQpIHtcclxuICAgICAgICAgICAgICAgICAgICBmaWVsZC5uYW1lID0gY2hhbmdlZDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSlcclxuICAgICAgICB9KTtcclxuICAgIH1cclxufSJdfQ==